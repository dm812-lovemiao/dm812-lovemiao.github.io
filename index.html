<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>特别的心意</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            love: '#ec4899',
          },
        }
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 2px 10px rgba(236, 72, 153, 0.3);
      }
      .heart-beat {
        animation: heartBeat 1.5s infinite;
      }
      .wiggle {
        animation: wiggle 1s ease-in-out infinite;
      }
      .star-twinkle {
        animation: twinkle 2s infinite alternate;
      }
      .star-float {
        animation: float 8s infinite ease-in-out;
      }
    }

    /* 核心动画定义 */
    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      14% { transform: scale(1.1); }
      28% { transform: scale(1); }
      42% { transform: scale(1.1); }
      70% { transform: scale(1); }
    }

    @keyframes wiggle {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }

    @keyframes twinkle {
      from { opacity: 0.5; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1.1); }
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      25% { transform: translate(10px, -10px); }
      50% { transform: translate(5px, 10px); }
      75% { transform: translate(-10px, 5px); }
    }

    /* 流星特效增强 */
    @keyframes starPulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1.2);
        text-shadow: 0 0 15px rgba(59, 130, 246, 1);
      }
      50% {
        opacity: 0.8;
        transform: scale(1);
        text-shadow: 0 0 10px rgba(59, 130, 246, 0.8);
      }
    }

    .meteor {
      position: absolute;
      pointer-events: none;
      z-index: 1;
    }

    .meteor-trail {
      position: absolute;
      background: linear-gradient(to right,
          rgba(59, 130, 246, 0.8) 0%,
          rgba(147, 197, 253, 0.6) 20%,
          rgba(147, 197, 253, 0.4) 40%,
          rgba(147, 197, 253, 0.2) 60%,
          rgba(147, 197, 253, 0.1) 80%,
          rgba(147, 197, 253, 0) 100%);
      transform-origin: left center;
      box-shadow: 0 0 12px 2px rgba(59, 130, 246, 0.3);
    }

    .meteor-star {
      position: absolute;
      color: #3b82f6;
      z-index: 2;
      animation: starPulse 0.6s infinite;
    }

    /* 背景渐变动画 */
    body {
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* 信封样式 */
    .envelope-scene {
      perspective: 1000px;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .envelope-wrapper {
      position: relative;
      width: 80%;
      max-width: 280px;
      height: 200px;
      cursor: pointer;
    }

    .envelope {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
    }

    .envelope-opened .envelope {
      transform: rotateX(180deg);
    }

    .envelope-front, .envelope-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .envelope-front {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .envelope-back {
      transform: rotateX(180deg);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding-top: 30px;
    }

    .envelope-flap {
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      height: 55%;
      background-color: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px 8px 0 0;
      transform-origin: bottom;
      transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1) 0.2s;
      z-index: 2;
    }

    .envelope-opened .envelope-flap {
      transform: rotateX(180deg);
    }

    .envelope-seal {
      position: absolute;
      width: 24px;
      height: 24px;
      color: #ec4899;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-shadow: 0 0 0 4px rgba(236, 72, 153, 0.2);
      z-index: 3;
      transition: all 0.5s ease-out;
      opacity: 1;
    }

    .envelope-opened .envelope-seal {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0);
    }

    .envelope-text {
      color: #5a3d5c;
      font-weight: 600;
      font-size: 18px;
      text-align: center;
      line-height: 1.5;
      padding: 0 15px;
    }

    /* 另一版入口样式 */
    .another-version {
      position: fixed;
      bottom: 20px;
      right: 20px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 14px;
      cursor: pointer;
      padding: 6px 10px;
      border-radius: 4px;
      transition: all 0.3s ease;
      background-color: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(4px);
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: all 0.5s ease;
    }

    .another-version.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .another-version:hover {
      color: white;
      background-color: rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-purple-900 flex items-center justify-center p-4 font-sans overflow-x-hidden relative">
  <!-- 星星背景 -->
  <div id="stars-container" class="fixed inset-0 pointer-events-none z-0"></div>

  <!-- 流星容器 -->
  <div id="meteors-container" class="fixed inset-0 pointer-events-none z-0"></div>


  <div class="max-w-4xl w-full mx-auto relative z-10">
    <!-- 初始问题界面 - 默认显示 -->
    <div id="stage1" class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 text-center transition-all duration-500 transform border border-pink-100">
      <h1 class="text-[clamp(1.5rem,4vw,2.2rem)] font-bold text-gray-800 mb-6 text-shadow">有件很重要的事想告诉你...</h1>
      <p class="text-[clamp(1.1rem,3vw,1.5rem)] text-gray-700 mb-10">我喜欢你，你愿意做我的女朋友吗？</p>

      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <button id="stage1-yes" class="bg-love hover:bg-love/90 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transform transition-all duration-300 hover:scale-105 heart-beat">
          愿意 <i class="fa fa-heart ml-1"></i>
        </button>
        <button id="stage1-no" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-8 rounded-full text-lg shadow transition-all duration-300">
          不愿意 <i class="fa fa-times ml-1"></i>
        </button>
      </div>
    </div>

    <!-- 第二阶段：包围的按钮 - 默认隐藏 -->
    <div id="stage2" class="hidden bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 text-center border border-pink-100">
      <h2 class="text-xl font-bold text-gray-800 mb-6 text-shadow">再认真考虑一下嘛？</h2>
      <p class="text-gray-600 mb-8">我的心意是认真的~</p>

      <div class="relative h-60 flex items-center justify-center mb-4">
        <button class="stage2-yes absolute bg-love hover:bg-love/90 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 hover:scale-105" style="top: 10%; left: 50%; transform: translateX(-50%);">
          愿意 <i class="fa fa-heart ml-1"></i>
        </button>
        <button class="stage2-yes absolute bg-love hover:bg-love/90 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 hover:scale-105" style="bottom: 10%; left: 50%; transform: translateX(-50%);">
          好呀 <i class="fa fa-smile-o ml-1"></i>
        </button>
        <button class="stage2-yes absolute bg-love hover:bg-love/90 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 hover:scale-105" style="top: 50%; left: 10%; transform: translateY(-50%);">
          可以 <i class="fa fa-thumbs-up ml-1"></i>
        </button>
        <button class="stage2-yes absolute bg-love hover:bg-love/90 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 hover:scale-105" style="top: 50%; right: 10%; transform: translateY(-50%);">
          我愿意 <i class="fa fa-heart ml-1"></i>
        </button>

        <button id="stage2-no" class="bg-gray-300 text-gray-800 font-bold py-3 px-8 rounded-full text-lg shadow transition-all duration-500 transform">
          不愿意 <i class="fa fa-times ml-1"></i>
        </button>
      </div>
    </div>

    <!-- 最终阶段：多个愿意按钮 - 默认隐藏 -->
    <div id="final-stage" class="hidden flex flex-col items-center justify-center w-full h-full">
      <h2 class="text-2xl font-bold text-white mb-2 text-shadow">这一定是命中注定！</h2>
      <p class="text-gray-200 mb-4">选一个按钮，让我知道你的答案吧~</p>
      <div id="button-container" class="flex flex-wrap justify-center gap-4">
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我愿意 ❤️</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我愿意 ❤️</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我爱你 ❤️</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">好呀 😊</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">好呀 😊</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我愿意</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">当然啦 👍</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">好呀 😊</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我爱你 ❤️</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">好呀 😊</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">当然啦 👍</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">当然啦 👍</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我愿意 ❤️</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">我也是</button>
        <button class="final-btn bg-love hover:bg-love/90 text-white font-bold py-2 px-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110">当然啦 👍</button>
      </div>
    </div>

    <!-- 信封弹窗 - 默认隐藏 -->
    <div id="envelope-popup" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex flex-col items-center justify-center p-4">
      <h3 class="text-2xl font-bold text-white mb-8 text-shadow text-center px-4">我有一份特别的信要给你</h3>
      <div class="envelope-scene">
        <div class="envelope-wrapper" id="envelope-wrapper">
          <div class="envelope-flap"></div>
          <div class="envelope-seal">
            <i class="fa fa-heart text-2xl"></i>
          </div>
          <div class="envelope">
            <div class="envelope-front">
              <i class="fa fa-envelope text-4xl text-love mb-2"></i>
              <p class="text-gray-700 font-medium">点击开启</p>
            </div>
            <div class="envelope-back">
              <p class="envelope-text">亲爱的，<br>从遇见你的那一刻起，<br>我就知道你是我要找的人。<br>往后余生，请多指教。</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 跳转提示 - 默认隐藏 -->
    <div id="redirect-message" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center transform transition-all scale-100 shadow-2xl border border-pink-100">
        <div class="text-6xl text-love mb-4 heart-beat">
          <i class="fa fa-heart"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-800 mb-4">回忆之旅即将开始</h2>
        <p class="text-gray-600 mb-6">让我们一起创造更多美好时光</p>
        <button id="redirect-btn" class="bg-love hover:bg-love/90 text-white font-bold py-3 px-8 rounded-full text-lg transition-all duration-300 hover:scale-105">
          开始 <i class="fa fa-arrow-right ml-1"></i>
        </button>
      </div>
    </div>
  </div>

  <script>
    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
      createStars();
      startMeteorShower();
      bindEvents();
    });

    // 创建星空背景（增强版）
    function createStars() {
      const container = document.getElementById('stars-container');
      const starCount = 200; // 增加星星数量

      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.innerHTML = '<i class="fa fa-star"></i>';

        // 随机星星属性
        const size = 2 + Math.floor(Math.random() * 10);
        const opacity = 0.3 + Math.random() * 0.7;
        const isBlue = Math.random() > 0.7;
        const delay = Math.random() * 5; // 随机动画延迟
        const floatDuration = 5 + Math.random() * 15; // 随机漂浮时间

        star.className = 'absolute star-twinkle star-float';
        star.style.color = isBlue ? '#93c5fd' : '#ffffff';
        star.style.fontSize = `${size}px`;
        star.style.opacity = opacity;
        star.style.animationDelay = `${delay}s`;
        star.style.animationDuration = `${floatDuration}s`;

        // 随机位置
        const x = Math.random() * 100;
        const y = Math.random() * 100;
        star.style.left = `${x}%`;
        star.style.top = `${y}%`;

        container.appendChild(star);
      }
    }

    // 创建流星（增强版）
    function createMeteor() {
      const container = document.getElementById('meteors-container');
      if (!container) return;

      const meteor = document.createElement('div');
      meteor.className = 'meteor';

      // 随机流星参数
      const angle = 15 + Math.random() * 45; // 15-60度的飞行角度
      const speed = 1.5 + Math.random() * 2; // 更快的流星速度
      const trailLength = 100 + Math.random() * 300; // 更长的拖尾
      const starSize = 14 + Math.random() * 8; // 更大的流星头部
      const isPink = Math.random() > 0.7; // 增加粉色流星

      // 创建拖尾
      const trail = document.createElement('div');
      trail.className = 'meteor-trail';
      trail.style.width = '2px';
      trail.style.height = `${trailLength}px`;
      trail.style.transform = `rotate(${angle}deg)`;

      // 粉色流星特殊样式
      if (isPink) {
        trail.style.background = 'linear-gradient(to right, rgba(236, 72, 153, 0.8) 0%, rgba(249, 115, 22, 0.6) 20%, rgba(249, 115, 22, 0.4) 40%, rgba(249, 115, 22, 0.2) 60%, rgba(249, 115, 22, 0.1) 80%, rgba(249, 115, 22, 0) 100%)';
        trail.style.boxShadow = '0 0 12px 2px rgba(236, 72, 153, 0.3)';
      }

      // 创建星星（流星头部）
      const star = document.createElement('div');
      star.className = 'meteor-star';
      star.innerHTML = '<i class="fa fa-star"></i>';
      star.style.fontSize = `${starSize}px`;
      star.style.left = '0px';
      star.style.top = '0px';
      if (isPink) {
        star.style.color = '#ec4899';
      }

      // 组合流星元素
      meteor.appendChild(trail);
      meteor.appendChild(star);

      // 随机起始位置（可能从左、上或右上）
      const startPositions = [
        {x: -200 - Math.random() * 300, y: -100 + Math.random() * 200}, // 左上
        {x: window.innerWidth + 200, y: -100 + Math.random() * 200}, // 右上
        {x: -200 + Math.random() * window.innerWidth, y: -200} // 顶部
      ];
      const startPos = startPositions[Math.floor(Math.random() * startPositions.length)];
      meteor.style.left = `${startPos.x}px`;
      meteor.style.top = `${startPos.y}px`;

      // 计算飞行角度和距离
      const radians = angle * (Math.PI / 180);
      const distanceX = Math.cos(radians) * (window.innerWidth + 800);
      const distanceY = Math.sin(radians) * (window.innerHeight + 800);

      // 应用动画
      meteor.style.transition = `transform ${speed}s cubic-bezier(0.2, 0.1, 0.3, 1) forwards`;
      setTimeout(() => {
        meteor.style.transform = `translate(${distanceX}px, ${distanceY}px)`;
      }, 10);

      // 添加到容器
      container.appendChild(meteor);

      // 动画结束后移除
      setTimeout(() => {
        if (meteor && meteor.parentNode) {
          meteor.parentNode.removeChild(meteor);
        }
      }, speed * 1000);
    }

    // 流星雨（增强版）
    function startMeteorShower() {
      // 初始生成更多流星
      for (let i = 0; i < 5; i++) {
        setTimeout(createMeteor, i * 1000);
      }

      // 更频繁地生成流星
      setInterval(() => {
        const randomDelay = Math.random() * 2000 + 500;
        setTimeout(createMeteor, randomDelay);
      }, 1500);
    }

    // 绑定交互事件（保持原有逻辑）
    function bindEvents() {
      let stage1Attempts = 0;
      const MAX_STAGE1_ATTEMPTS = 5;

      let stage2Attempts = 0;
      const MAX_STAGE2_ATTEMPTS = 5;

      const targetUrl = "start.html";
      const anotherVersionUrl = "baobao.html";

      // 获取DOM元素
      const stage1 = document.getElementById('stage1');
      const stage2 = document.getElementById('stage2');
      const finalStage = document.getElementById('final-stage');
      const envelopePopup = document.getElementById('envelope-popup');
      const envelopeWrapper = document.getElementById('envelope-wrapper');
      const redirectMessage = document.getElementById('redirect-message');
      const redirectBtn = document.getElementById('redirect-btn');
      const anotherVersion = document.getElementById('another-version');

      // 显示信封弹窗
      function showEnvelope() {
        // 隐藏所有阶段
        document.querySelectorAll('div[id^="stage"]').forEach(stage => {
          stage.classList.add('hidden');
        });
        envelopePopup.classList.remove('hidden');
      }

      // 第一阶段：初始表白
      const stage1Yes = document.getElementById('stage1-yes');
      const stage1No = document.getElementById('stage1-no');

      // 点击"愿意"直接显示信封
      stage1Yes.addEventListener('click', showEnvelope);

      // "不愿意"按钮躲避逻辑
      stage1No.addEventListener('mouseover', () => {
        stage1Attempts++;

        // 达到最大尝试次数，进入第二阶段
        if (stage1Attempts >= MAX_STAGE1_ATTEMPTS) {
          stage1.classList.add('opacity-0', 'scale-95');
          setTimeout(() => {
            stage1.classList.add('hidden');
            stage2.classList.remove('hidden');
          }, 300);
          return;
        }

        // 计算随机位置让按钮"躲避"
        const container = stage1.getBoundingClientRect();
        const btnWidth = stage1No.offsetWidth;
        const btnHeight = stage1No.offsetHeight;

        const maxX = container.width - btnWidth - 20;
        const maxY = container.height - btnHeight - 20;

        // 确保按钮不会超出容器范围
        const randomX = Math.floor(Math.random() * maxX);
        const randomY = Math.floor(Math.random() * maxY);

        stage1No.style.position = 'relative';
        stage1No.style.left = `${randomX}px`;
        stage1No.style.top = `${randomY}px`;
      });

      // 第二阶段：周围都是同意按钮
      document.querySelectorAll('.stage2-yes').forEach(btn => {
        btn.addEventListener('click', showEnvelope);
      });

      // 第二阶段的"不愿意"按钮
      const stage2No = document.getElementById('stage2-no');
      stage2No.addEventListener('mouseover', () => {
        stage2Attempts++;

        if (stage2Attempts >= MAX_STAGE2_ATTEMPTS) {
          stage2.classList.add('opacity-0', 'scale-95');
          setTimeout(() => {
            stage2.classList.add('hidden');
            finalStage.classList.remove('hidden');
            // 显示另一版入口
            anotherVersion.classList.add('visible');
          }, 300);
          return;
        }

        // 让按钮在更大范围内移动
        const container = stage2.querySelector('.relative');
        const rect = container.getBoundingClientRect();
        const btnWidth = stage2No.offsetWidth;
        const btnHeight = stage2No.offsetHeight;

        const maxX = rect.width - btnWidth - 40;
        const maxY = rect.height - btnHeight - 40;

        const randomX = Math.floor(Math.random() * maxX) - (maxX / 2);
        const randomY = Math.floor(Math.random() * maxY) - (maxY / 2);

        stage2No.style.transform = `translate(${randomX}px, ${randomY}px)`;
      });

      // 最终阶段所有按钮都显示信封
      document.querySelectorAll('.final-btn').forEach(btn => {
        btn.addEventListener('click', showEnvelope);
      });

      // 信封点击事件
      envelopeWrapper.addEventListener('click', function() {
        this.classList.toggle('envelope-opened');

        // 打开后延迟显示跳转提示
        if (this.classList.contains('envelope-opened')) {
          setTimeout(() => {
            envelopePopup.classList.add('hidden');
            redirectMessage.classList.remove('hidden');
          }, 2000);
        }
      });

      // 跳转按钮
      redirectBtn.addEventListener('click', function() {
        window.location.href = targetUrl;
      });

      // 另一版入口
      anotherVersion.addEventListener('click', function() {
        window.location.href = anotherVersionUrl;
      });
    }
  </script>
</body>
</html>